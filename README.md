> TFG EN GESTI ´O DE CIUTATS INTEL·LIGENTS I SOSTENIBLES, UNIVERSITAT
> AUT \` ONOMA DE BARCELONA (UAB)
>
> Predicci´o de la demanda energ\` etica per barris de Barcelona per a
> una gesti´o sostenible dels recursos.

Aleix Franc´ıa Albert

> **Resum--** L'electricitat constitueix un element fonamental de la
> societat contempor\` ania i un indicador del desenvolupament tecnol\`
> ogic.
>
> El repte de garantir un ´us sostenible dels recursos es presenta com
> una prioritat global, on l'opti- o esdev´e un instrument essencial.
> D'acord amb l'Ag\` encia Internacional de l'Energia (AIE), el
> mitzaci´\
> consum energ\` etic a l'Uni´o Europea va disminuir un 3,2% el 2022, la
> segona m´es gran des de 2009.
>
> o, els preus negatius de l'electricitat s'han fet m´es freq¨uents,
> re-Tot i que es preveu una recuperaci´\
> flectint la inestabilitat del mercat i la necessitat d'una millor
> administraci´o.
>
> Aquest estudi es concentra en la predicci´o de la demanda el\` ectrica
> a la ciutat de Barcelona, mitjanc¸ant l'´us d'algoritmes d'intel·lig\`
> encia artificial. Aquestes prediccions i la incertesa associada,
> proporcionen eines per a l'optimitzaci´o i la gesti´o dels recursos.
>
> **Paraules clau--** Efici\` encia energ\` etica, consum el\` ectric,
> predicci´o de demanda, intel·lig\` encia artificial, volatilitat del
> mercat, Barcelona.
>
> **Abstract--** Electricity is a fundamental element of contemporary
> society and an indicator of techno-logical development.
>
> The challenge of ensuring the sustainable use of resources is
> presented as a global priority, where optimization becomes an
> essential tool. According to the International Energy Agency (IEA),
> energy consumption in the European Union decreased by 3.2% in 2022,
> the second-largest drop since 2009. Although recovery is expected,
> negative electricity prices have become more common, reflecting market
> instability and the need for better management.
>
> This study focuses on predicting electricity demand in the city of
> Barcelona, using artificial intelligence algorithms. These predictions
> and the associated uncertainty provide tools for the optimization and
> management of resources.
>
> **Keywords--** Energy efficiency, electricity consumption, demand
> forecasting, artificial intelligen-ce, market volatility, Barcelona.

✦

> noci´o de la producci´o necess\` aria per reduir la malversaci´o\
> de recursos.

+-----------------------------------+-----------------------------------+
| > **1**                           | > **INTRODUCCI ´O**               |
+===================================+===================================+
| > L sos energ\` necessitat de     |                                   |
| > reduir les emissions de gasos   |                                   |
| > conta-minants, ha convertit la  |                                   |
| > gesti´etics en un dels grans    |                                   |
| > desafiaments de les ciutats o   |                                   |
| > eficient dels recur-A La        |                                   |
| > creixent demanda d'energia,     |                                   |
| > combinada amb la                |                                   |
| >                                 |                                   |
| > modernes. Aquest desafiament    |                                   |
| > ´es especialment rellevant a    |                                   |
| > mesura que l'energia continua   |                                   |
| > sent un recurs limitat, i degut |                                   |
| > a la impossibilitat             |                                   |
| > d'emmagatzemar energia de       |                                   |
| > manera efi-cient. Tret que      |                                   |
| > emfatitza la necessitat de      |                                   |
| > tindre una major                |                                   |
+-----------------------------------+-----------------------------------+
| > form\`*• E-mail de contacte:*   |                                   |
| > afranciaa2501@gmail.com*•       |                                   |
| > Treball tutoritzat per:* Albert |                                   |
| > Romero S´atica) anchez          |                                   |
| > (Departament d'In-              |                                   |
| >                                 |                                   |
| > *• Curs 2024/2025*              |                                   |
+-----------------------------------+-----------------------------------+

> El creixement global en el consum energ\` etic, especial-
>
> ment en regions com \` Asia i Oceania, on l'economia xinesa
>
> ha estat un dels principals motors del consum energ\` etic, fa
>
> que la recerca en efici\` encia energ\` etica (EE) hagi guanyat
>
> una gran rellev\` ancia. El consum energ\` etic global ha aug-
>
> mentat m´es del 50% entre 1993 i 2012. A mesura que les
>
> ciutats es mouen cap a economies m´es basades en serveis,
>
> l'efici\` encia energ\` etica en els processos productius no perdr\` a
>
> la seva rellev\` ancia.
>
> Aquest estudi es concentra en la predicci´o de la deman-
>
> da el\` ectrica a Barcelona, desglossada per codis postals. Per
>
> poder afrontar aquest repte, es far\` a ´us de diferents t\` ecniques
>
> d'intel·lig\` encia artificial i aprenentatge autom\` atic, com els

Curs acad\` emic 2024-2025, Escola d'Enginyeria (UAB)

2 TFG GESTI ´O CIUTATS INTEL·LIGENTS: Predicci´o de la demanda energ\`
etica de Barcelona

arbres de decisi´o i les xarxes neuronals, i es mesuraren

els resultats d'aquests a trav´es de diferents m\` etriques, amb

l'objectiu de millorar la precisi´o i fiabilitat de les predicci-

ons.

> A m´es de la creaci´o del model predictiu, durant aquest

proc´es es podr\` a extreure coneixement de la naturalesa del

fenomen i del consum energ\` etic de la regi´o de Barcelona.

Aix\` o permetr\` a una millor comprensi´o de les din\` amiques

energ\` etiques locals i millorar la capacitat de resposta davant

de fluctuacions en la demanda.

> Un dels objectius principals d'aquest treball ´es gene-

rar una eina que permeti una millor gesti´o dels recursos

energ\` etics i minimitzi l'impacte de la volatilitat del mer-

cat energ\` etic. A m´es, s'analitza la incertesa associada a

aquestes prediccions per garantir la fiabilitat dels resultats

obtinguts i oferir una eina m´es per a la presa de decisions.

En conclusi´o, l'´us de sistemes d'IA per a la predicci´o de la

demanda energ\` etica suposa un avanc¸ cap a una gesti´o m´es

eficient, fent un ´us m´es responsable dels recursos disponi-

bles, sense comprometre el desenvolupament de la societat

i les necessitats associades a la ciutat contempor\` ania.

> **2** **EDA(*Exploratory Data Analysis*)**

Un cop realitzat el preprocessament de les dades, es desen-

volupar\` a una an\` alisi explorat\` oria mitjanc¸ant t\` ecniques es-

tad´ıstiques i visuals per comprendre la naturalesa del feno-

men de la demanda energ\` etica. L'objectiu principal ´es iden-

tificar patrons, tend\` encies, valors at´ıpics i relacions entre

variables, de manera que s'obtingui una millor comprensi´o

de les dades i es faciliti el posterior desenvolupament del

model predictiu.

**2.1 Distribuci´o del consum per codi postal.**

Com es pot apreciar, la distribuci´o del consum energ\` etic no

es homog\` enia al llarg de la superf´ıcie de Barcelona, ja que

existeixen grans difer\` encies en la demanda entre els diver-

sos barris de la ciutat.

> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image1.png){width="2.9499989063867016in"
> height="2.4624989063867018in"}
>
> Fig. 1: Consum energ\` etic per codi postal.

**2.2 An\` alisi histogr\` afica i tend\` encia temporal**

L'histograma i el diagrama de caixes mostren una tend\` encia

a la reducci´o del consum energ\` etic al llarg dels anys, pot ser

> deguda a una major conscienciaci´o sobre l'impacte ambien-

tal i als avanc¸os en l'efici\` encia energ\` etica dels dispositius.

> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image2.png){width="1.6736111111111112in"
> height="1.119443350831146in"}![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image3.png){width="1.538888888888889in"
> height="0.9541655730533684in"}
>
> Fig. 2: Histograma. Fig. 3: Consum Anual.
>
> **2.3 Consum mensual i diari**
>
> El consum mensual segueix un patr´o que influencia el con-
>
> sum energ\` etic. En canvi, no podem apreciar el mateix tipus
>
> d'influ\` encia amb la distribuci´o del consum diari. La distri-
>
> buci´o del valor depenent del dia cont´e fluctuaci´ons, per\` o no
>
> segueix una tend\` encia clara.
>
> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image4.png){width="1.6069433508311461in"
> height="0.995832239720035in"}![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image5.png){width="1.6069444444444445in"
> height="0.995832239720035in"}
>
> Fig. 4: Consum Mensual. Fig. 5: Consum Diari.
>
> **2.4 Distribuci´o segons tram horari**
>
> El tram horari ´es una de les variables independents que re-
>
> tribueixen a la demanda de forma directa, aquesta relaci´o ve
>
> donada per l'activitat socioecon\` omica. El tram de **12h-18h**
>
> es el que t´e un consum major, i el tram amb menys activi-
>
> tat ´es el de **0h-6h**, destacat per la seva redu¨ıda variabilitat.
>
> Tots ells on es produeix una activitat socioecon\` omica simi-
>
> lar, contenen una desviaci´o est\` andard similar.
>
> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image6.png){width="1.6069433508311461in"
> height="0.9972211286089239in"}![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image7.png){width="1.6069444444444445in"
> height="0.9972211286089239in"}
>
> Fig. 6: Evoluci´o per tram. Fig. 7: Diagrama de caixes

per tram.

> **2.5 Influ\` encia de les variables independents**
>
> Per poder comprendre la influ\` encia de les diferents vari-
>
> ables independents seleccionades, respecte la variable de-
>
> pendent, s'ha elaborat el seg¨uent mapa de calor amb dife-
>
> rents tipus de correlacions.
>
> • **Pearson**: Mesura la relaci´o lineal entre dues variables.
>
> • **Spearman**: Mesura la relaci´o mon\` otona(quan dues
>
> variables evolucionen en la mateixa direcci´o), per\` o no
>
> necess\` ariament de manera lineal.

AUTOR: Aleix Franc´ıa Albert 3

> • **Correlaci´o de Dist\` ancia (DCOR)**: Mesura tot tipus
>
> de depend\` encia entre dues variables, ja sigui lineal o
>
> no lineal.

+-----------------+-----------------+-----------------+-----------------+
| > **Variable**  | **Pearson**     | **Spearman**    | **Distance      |
|                 |                 |                 | Correlation**   |
+=================+=================+=================+=================+
| > isday         |   ------------  |   ------------  |   ------------  |
|                 |   0.205         |   0.213         |   0.907         |
| +------------+  |   ------------  |   ------------  |   ------------  |
| | >          |  |                 |                 |                 |
| | TramHorari |  |   ------------  |   ------------  |   ------------  |
| +============+  |                 |                 |                 |
| +------------+  |   ------------  |   ------------  |   ------------  |
|                 |   0.258         |   0.287         |   0.283         |
| > s             |   ------------  |   ------------  |   ------------  |
| unshineduration |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
| | > direc    |  |   ------------  |   ------------  |   ------------  |
| | tradiation |  |   0.217         |   0.229         |   0.220         |
| +============+  |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
| > CodiPostal    |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
| +------------+  |   0.197         |   0.240         |   0.201         |
| | > tem      |  |   ------------  |   ------------  |   ------------  |
| | perature2m |  |                 |                 |                 |
| +============+  |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
| > Festiu        |   0.037         |   -0.029        |   0.126         |
|                 |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
| | > wi       |  |   ------------  |   ------------  |   ------------  |
| | ndspeed10m |  |                 |                 |                 |
| +============+  |   ------------  |   ------------  |   ------------  |
| +------------+  |   0.133         |   0.121         |   0.124         |
|                 |   ------------  |   ------------  |   ------------  |
| appa            |                 |                 |                 |
| renttemperature |   ------------  |   ------------  |   ------------  |
|                 |                 |                 |                 |
| +------------+  |   ------------  |   ------------  |   ------------  |
| | >          |  |   -0.054        |   -0.049        |   0.115         |
| | DiaSetmana |  |   ------------  |   ------------  |   ------------  |
| +============+  |                 |                 |                 |
| +------------+  |   ------------  |   ------------  |   ------------  |
|                 |                 |                 |                 |
| > rain          |   ------------  |   ------------  |   ------------  |
|                 |   0.102         |   0.117         |   0.109         |
| +------------+  |   ------------  |   ------------  |   ------------  |
| | > Any      |  |                 |                 |                 |
| +============+  |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
|                 |   ------------  | 0.100           |   ------------  |
| Tasa interanual |   0.111         |                 |   0.106         |
| del IPI         |   ------------  |   ------------  |   ------------  |
|                 |                 |   -0.099        |                 |
| +------------+  |   ------------  |   ------------  |   ------------  |
| | >          |  |                 |                 |                 |
| | dewpoint2m |  |   ------------  |   ------------  |   ------------  |
| +============+  |   -0.111        |                 |   0.102         |
| +------------+  |   ------------  | 0.016           |   ------------  |
|                 |                 |                 |                 |
| > Mes           |   ------------  |   ------------  |   ------------  |
|                 |                 |   -0.091        |                 |
| +------------+  |   ------------  |   ------------  |   ------------  |
| | > Dia      |  |   0.013         |                 |   0.095         |
| +============+  |   ------------  |   ------------  |   ------------  |
| +------------+  |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
|                 |                 |   -0.007        |                 |
|                 |   ------------  |   ------------  |   ------------  |
|                 |   -0.084        |                 |   0.078         |
|                 |   ------------  |   ------------  |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  |   ------------  |   ------------  |
|                 |                 |   0.039         |                 |
|                 |   ------------  |   ------------  |   ------------  |
|                 |   0.008         |                 |   0.053         |
|                 |   ------------  |   ------------  |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  | > 0.018\        |   ------------  |
|                 |                 | > 0.001         |                 |
|                 |   ------------  |                 |   ------------  |
|                 |   0.044         |                 |   0.050         |
|                 |   ------------  |                 |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  |                 |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  |                 |   ------------  |
|                 |   0.019         |                 |   0.042         |
|                 |   ------------  |                 |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  |                 |   ------------  |
|                 |                 |                 |                 |
|                 |   ------------  |                 | 0.006           |
|                 |   0.001         |                 |                 |
|                 |   ------------  |                 |                 |
|                 |                 |                 |                 |
|                 |   ------------  |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

TAULA 1: COMPARACI ´O DE PEARSON, SPEARMAN I

> DISTANCE CORRELATION AMB VALOR
>
> **3** **RANDOM FOREST REGRESSOR**

El **RandomForestRegressor** ´es un model de regressi´o que

fa servir un conjunt de m´ultiples arbres de decisi´o per fer

prediccions. Aquest model utilitza una t\` ecnica anomenada

**bagging** per generar arbres de decisi´o complets en paral·lel

a partir d'un subconjunt aleatori de les dades i de carac-

ter´ıstiques.

> La predicci´o final ´es una mitjana de totes les prediccions

dels diferents arbres de decisi´o.

![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image8.png){width="1.8069444444444445in"
height="1.5124989063867016in"}![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image9.png){width="1.070832239720035in"
height="1.4180555555555556in"}

> Fig. 8: RandomForestRegressor. Fig. 9: Bagging.
>
> Es adequat per a la nostra tasca, ja que el fet d'entrenar´

cada arbre amb subconjunts diferents de les dades, mini-

mitza la depend\` encia entre ells, tret que augmenta la se-

va robustesa i capacitat de generalitzaci´o. A m´es, ´es capac

de manejar relacions no lineals i funciona de manera eficac

amb dades sorolloses o *outliers*(valors at´ıpics).

**3.1 Selecci´o de Caracter´ıstiques**

Aquesta eina del Random Forest permet calcular la im-

port\` ancia de cada variable i, juntament amb la matriu de

correlaci´o, seleccionar les variables que aporten m´es infor-

maci´o i que expliquen millor el comportament de la variable

dependent. Els resultats obtinguts amb diferents conjunts

de caracter´ıstiques indiquen que el model s'ajusta millor al

fenomen quan es fa servir un major nombre de variables, no

obstant, per evitar l'*overfitting*, es procedeix a eliminar les

> variables que no aporten un valor significatiu al model, ja
>
> que podrien generar soroll.
>
> Un cop seleccionades les caracter´ıstiques \` optimes per
>
> modelar el fenomen, s'utilitza l'eina **GridSearchCV** per
>
> identificar els hiperpar\` ametres que ofereixen millor rendi-
>
> ment per al conjunt de dades. D'aquesta manera, es maxi-
>
> mitza la precisi´o del model sense sacrificar la seva genera-
>
> litzaci´o.
>
> **3.2 Quantificaci´o de la incertesa associada**
>
> Amb aquest model tamb´e podem quantificar la incertesa as-
>
> sociada a cada predicci´o de la variable objectiu, la calculem
>
> amb la desviaci´o est\` andard de les prediccions de cadascun
>
> dels arbres.
>
> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image10.png){width="3.011111111111111in"
> height="1.4958333333333333in"}

Fig. 10: Incertesa associada.

> **4** **EXTREME GRADIENT BOOSTING**
>
> XGBoost ´es una t\` ecnica d'aprenentatge autom\` atic d'arbre
>
> de decisions augmentat amb gradient (**GBDT**) escalable i
>
> distribu¨ıda, pertany a la fam´ılia dels models d'*ensemble le-*
>
> *arning*. Els **GBDT** entrenen de manera seq¨uencial un con-
>
> junt d'arbres de decisi´o poc profunds, amb cada iteraci´o
>
> utilitzant els residus d'error del model anterior, els arbres
>
> nous s'optimitzen per corregir els errors dels arbres previs.
>
> La predicci´o final ´es una suma ponderada de totes les pre-
>
> diccions de l'arbre.
>
> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image11.png){width="2.008332239720035in"
> height="1.0in"}![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image12.png){width="1.0708333333333333in"
> height="1.4166666666666667in"}
>
> Fig. 11: XGBoost.

Fig. 12: Boosting.

> Tant el **random forest** com el **GBDT** construeixen un
>
> model que consta de m´ultiples arbres de decisi´o, la di-
>
> fer\` encia est\` a en com es construeixen i es combinen els ar-
>
> bres. El **random forest** minimitza la vari\` ancia i l'exc´es
>
> d'ajust, mentre que el *boost* de **GBDT** minimitza el *bias*
>
> i l'ajustament insuficient.
>
> El terme *gradient boosting* prov´e de la idea de **boost** o
>
> millorar un ´unic model feble combinant-lo amb una s\` erie
>
> d'altres models febles per tal de generar un model col·lectiu
>
> fort. L'augment del gradient estableix resultats objectius

4 TFG GESTI ´O CIUTATS INTEL·LIGENTS: Predicci´o de la demanda energ\`
etica de Barcelona

per al seg¨uent model en un esforc¸ per minimitzar els er-

rors. El m\` etode *gradient boosting* es millora mitjanc¸ant la

t\` ecnica de segona derivada (o *Taylor Expansion*) sobre la

funci´o de p\` erdua , el que fa que el model sigui molt m´es

r\` apid i efectiu en comparaci´o amb altres t\` ecniques *gradient*

*boosting* tradicionals.

**4.1 Hyper Par\` ametres seleccionats**

Els hiper par\` ametres, controlen el proc´es d'aprenentat-

ge d'un model. En el cas de XGBoost, aquests hiper

par\` ametres determinen el creixement dels arbres i l'optimit-

zaci´o del model.

> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image13.png){width="1.6388877952755905in"
> height="1.273611111111111in"}
>
> Fig. 13: Nombre d'estimadors.
>
> S'ha optat per definir una graella d'hiper par\` ametres, per

explorar diferents combinacions de valors i trobar la millor

configuraci´o mitjanc¸ant una t\` ecnica d'optimitzaci´o anome-

nada **GridSearchCV**, ja utilitzada pr\` eviament. A m´es de

l'utilitzaci´o de regularitzaci´o **Elastic Net**.

> • **reg lambda**: Aplica una penalitzaci´o quadr\` atica als
>
> pesos dels arbres, ajuda a reduir la variabilitat dels
>
> par\` ametres i evita que alguns pesos es tornin exces-
>
> sivament grans. La f´ormula ´es:

*n*

> L2 Regularization = *λ* *w*2 *i*

*i*=1

> On *λ* ´es el coeficient de regularitzaci´o i *wi* s´on els pe-
>
> sos dels arbres.
>
> • **reg alpha**: Aplica una penalitzaci´o absoluta als pesos,
>
> el que afavoreix que algunes caracter´ıstiques esdevin-
>
> guin exactament zero, promovent aix´ı l'esparsitat del
>
> model. La f´ormula ´es:

*n*

+-----------------------+-----------------------+-----------------------+
| L1 Regularization =   | *i*=1                 | > *\|wi\|*            |
| *α*                   |                       |                       |
+=======================+=======================+=======================+
+-----------------------+-----------------------+-----------------------+

> On *α* ´es el coeficient de regularitzaci´o i *wi* s´on els pe-
>
> sos dels arbres.
>
> • **Elastic Net**: Combina les penalitzacions L1 (Lasso) i
>
> L2 (Ridge). La f´ormula ´es:
>
> **4.2 Monte Carlo Ensemble**
>
> Es una t\`´ecnica basada en la simulaci´o aleat\` oria per estimar
>
> la incertesa en les prediccions d'un model. En lloc d'en-
>
> trenar m´ultiples models com en el **Bootstrap Ensemble**,
>
> es fa servir un ´unic model per\` o introduint-hi variabilitat en
>
> el proc´es de predicci´o. Aquesta variabilitat es pot afegir a
>
> trav´es de t\` ecniques com la submostra d'arbres en models
>
> d'ensamblatge. En fer m´ultiples prediccions per a la matei-
>
> xa entrada per\` o amb petites variacions aleat\` ories, s'obt´e una
>
> distribuci´o de prediccions que permet calcular un interval
>
> de predicci´o de manera similar a com es fa en el **Bootstrap**
>
> **Ensemble**.
>
> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image14.png){width="3.2444433508311463in"
> height="1.788888888888889in"}
>
> Fig. 14: Monte Carlo Ensemble.
>
> Aquesta t\` ecnica ´es \` ampliament utilitzada quan es vol
>
> obtenir una mesura de la incertesa sense haver d'entrenar
>
> m´ultiples models, fent que sigui m´es eficient en termes de
>
> c\` alcul.
>
> **4.3 Bootstrap Ensemble**
>
> Es una t\`´ecnica estad´ıstica basada en la creaci´o de m´ultiples
>
> mostres aleat\` ories de les dades disponibles. L'objectiu ´es
>
> obtenir una millor estimaci´o de la incertesa d'un model
>
> de predicci´o. Aquesta t\` ecnica es basa en el mostreig amb
>
> reemplac¸ament, que significa que es creen noves mostres
>
> de dades escollint aleat\` oriament elements de la mostra ori-
>
> ginal, per\` o permetent repeticions.
>
> Cada una d'aquestes mostres es fa servir per entrenar un
>
> model independent. Quan volem fer una predicci´o, es fan
>
> servir tots aquests models i es combinen els resultats per
>
> obtenir una distribuci´o de prediccions, ´es una combinaci´o
>
> entre utilitzar el *boost* del **XGBoost** i a la vegada tindre
>
> m´ultiples arbres que generen valors de regressi´o diversos.
>
> Aquesta distribuci´o permet estimar un interval de predicci´o
>
> capturant l'abast de la variabilitat de les prediccions gene-
>
> rades.
>
> Aquesta t\` ecnica ´es molt ´util quan es vol tenir una estima-
>
> ci´o de la incertesa sense necessitat de fer suposicions sobre
>
> la distribuci´o dels errors del model. A m´es, com que es basa
>
> en l'´us de m´ultiples models, tamb´e pot ajudar a millorar la
>
> generalitzaci´o de les prediccions.

+-----------+-----------+-----------+-----------+-----------+-----------+
| > M       | Loss      | *\|w      | *w*2 *i*  | **5**     | > **XARXA |
| inimitzar | Func      | i\|*+*λ*2 |           |           | >         |
|           | tion+*λ*1 |           |           |           |  NEURONAL |
|           |           |           |           |           | > (CNN)** |
+===========+===========+===========+===========+===========+===========+
+-----------+-----------+-----------+-----------+-----------+-----------+

> On *λ*1 controla la penalitzaci´o L1 i *λ*2 controla la pe-
>
> nalitzaci´o L2.
>
> A continuaci´o farem diverses proves sobre un model inicial,
>
> el model ´es el seg¨uent.

AUTOR: Aleix Franc´ıa Albert 5

+-----------------+-----------------+-----------------+-----------------+
| > **Layer**     | **Input Shape** | **Output        | **Param \#**    |
|                 |                 | Shape**         |                 |
+=================+=================+=================+=================+
| > InputLayer    | (None, 15, 1)   | (None, 15, 1)   | 0               |
+-----------------+-----------------+-----------------+-----------------+
| > LSTM          | (None, 15, 1)   | (None, 15, 64)  | 16,896          |
+-----------------+-----------------+-----------------+-----------------+
| GlobalAvgPool1D | (None, 15, 64)  | (None, 64)      | 0               |
+-----------------+-----------------+-----------------+-----------------+
| > Dense(ReLU)   | (None, 64)      | (None, 256)     | 16,640          |
+-----------------+-----------------+-----------------+-----------------+
| > BatchNorm     | (None, 256)     | (None, 256)     | 1,024           |
+-----------------+-----------------+-----------------+-----------------+
| > Dropout(0.19) | (None, 256)     | (None, 256)     | 0               |
+-----------------+-----------------+-----------------+-----------------+
| > Dense(ReLU)   | (None, 256)     | (None, 32)      | 8,224           |
+-----------------+-----------------+-----------------+-----------------+
| > BatchNorm     | (None, 32)      | (None, 32)      | 128             |
+-----------------+-----------------+-----------------+-----------------+
| > Dropout(0.5)  | (None, 32)      | (None, 32)      | 0               |
+-----------------+-----------------+-----------------+-----------------+
| > Dense(Linear) | (None, 32)      | (None, 1)       | 33              |
+-----------------+-----------------+-----------------+-----------------+

> TAULA 2: NEURAL NETWORK MODEL SUMMARY

**5.1 Long Short-Term Memory(LSTM)**

Primer s'ha entrenat i evaluat fent ´us de l'activaci´o **ReLU** i

introdu¨ınt el concepte **LSTM** (Long Short-Term Memory),

es un tipus de **RNN**(Red Neuronal Recurrent), dissenyada

per capturar depend\` encies a llarg termini en seq¨u\` encies de

dades, ´es possible per l'estructura de portes. L'estructura-

ci´o amb portes permet mantindre la mem\` oria d'informaci´o

rellevant, durant llargs per´ıodes, mentre que les **RNN** tradi-

cionals no poden fer-ho.

> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image15.png){width="2.2944444444444443in"
> height="1.3916666666666666in"}

Fig. 15: LSTM.

> Els LSTM funcionen a trav´es de les seg¨uents portes de

controlen el flux d'informaci´o:

+-----------------------+-----------------------+-----------------------+
| > • **Porta           |                       |                       |
| > d'                  |                       |                       |
| oblidament**:Decideix |                       |                       |
| > quina informaci´o   |                       |                       |
| > de la               |                       |                       |
| >                     |                       |                       |
| > mem\` oria es       |                       |                       |
| > mant´e o es         |                       |                       |
| > descarta, el valor  |                       |                       |
| > de la porta ´es     |                       |                       |
| >                     |                       |                       |
| > una valoraci´o      |                       |                       |
| > entre 0             |                       |                       |
| > (l'informaci´o es   |                       |                       |
| > descarta) i 1 (la   |                       |                       |
| >                     |                       |                       |
| > informaci´o es      |                       |                       |
| > mant´e).            |                       |                       |
|                       |                       |                       |
| • **Porta             |                       |                       |
| d'entrada**: Decideix |                       |                       |
| quina informaci´o     |                       |                       |
| nova                  |                       |                       |
|                       |                       |                       |
| > s'afegeix a la      |                       |                       |
| > mem\` oria,         |                       |                       |
| > Combinant l'*input* |                       |                       |
| > actual amb          |                       |                       |
| >                     |                       |                       |
| > l'estat anterior.   |                       |                       |
| > La porta d'entrada  |                       |                       |
| > utilitza una        |                       |                       |
| > funci´o             |                       |                       |
| >                     |                       |                       |
| > d'activaci´o        |                       |                       |
| > (normalment una     |                       |                       |
| > **sigmoide**) per   |                       |                       |
| > controlar           |                       |                       |
| >                     |                       |                       |
| > l'actualitzaci´o.   |                       |                       |
+=======================+=======================+=======================+
| *σ*(*x*) =            |                       | > 1                   |
+-----------------------+-----------------------+-----------------------+
|                       |                       | > 1 + *e−x*           |
+-----------------------+-----------------------+-----------------------+
| • **Porta de          | Determina quina       |                       |
| sortida**:            | informaci´o es        |                       |
+-----------------------+-----------------------+-----------------------+
| > transmet a la       |                       |                       |
| > seg¨uent capa o com |                       |                       |
| > a *output*, tamb´e  |                       |                       |
| > fa                  |                       |                       |
| >                     |                       |                       |
| > servir l'activaci´o |                       |                       |
| > **sigmoide** per    |                       |                       |
| > decidir el flux     |                       |                       |
| > d'infor-            |                       |                       |
| >                     |                       |                       |
| > maci´o.             |                       |                       |
+-----------------------+-----------------------+-----------------------+

> L'**LSTM** tradicional processa la seq¨u\` encia d'entrada en

una ´unica direcci´o (generalment d'esquerra a dreta). L'estat

de la xarxa en cada moment dep\` en de l'entrada i de l'estat

anterior, apr\` en depend\` encies passades, per predir futures.

**5.2 Activaci´o**

L'activaci´o ´es el proc´es mitjanc¸ant el qual una neurona

transforma la seva entrada (un valor ponderat) en una sorti-

> da utilitzant una funci´o d'activaci´o, ´es fonamental per intro-
>
> duir no linealitat dins de la xarxa neuronal, l'ess\` encia de les
>
> xarxes neuronals. Per el nostre estudi, utilitzarem diverses
>
> variacions de la funci´o **ReLU** , que ´es la funci´o d'activaci´o
>
> inicialment implementada al model.
>
> • **ReLU (Rectified Linear Unit):**

*f*(*x*) = max(0*, x*)

> • **LeakyReLU (Leaky Rectified Linear Unit):**

+-----------------------+-----------------------+-----------------------+
| *f*(*x*) =            | > *x,*                | > si *x \>* 0         |
+=======================+=======================+=======================+
|                       | *αx,*                 | > si *x \<* 0         |
+-----------------------+-----------------------+-----------------------+

> • **ELU (Exponential Linear Unit):**

+-----------------------+-----------------------+-----------------------+
| *f*(*x*) =            | > *x,*                | > si *x \>* 0         |
+=======================+=======================+=======================+
|                       | *α*(*ex−*1)*,*        | > si *x \<* 0         |
+-----------------------+-----------------------+-----------------------+

> Com es pot apreciar a la seg¨uent taula, elaborada a par-
>
> tir de l'estudi \[1\], cada activaci´o presenta un comportament
>
> diferent segons el tipus de conjunt de dades. Es poden ob-
>
> servar difer\` encies significatives entre elles, tant en el temps
>
> de computaci´o com en el resultat.

+---------+---------+---------+---------+---------+---------+---------+
| **A     |         |         |         |         |         |         |
| ccuracy |         |         |         |         |         |         |
| results |         |         |         |         |         |         |
| com     |         |         |         |         |         |         |
| parison |         |         |         |         |         |         |
| over    |         |         |         |         |         |         |
| C       |         |         |         |         |         |         |
| IFAR100 |         |         |         |         |         |         |
| da      |         |         |         |         |         |         |
| taset** |         |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
| **Activ | **Mobi  | **      | **Goog  | **Res   | **SE    | *       |
| ation** | leNet** | VGG16** | leNet** | Net50** | Net18** | *DenseN |
|         |         |         |         |         |         | et121** |
+---------+---------+---------+---------+---------+---------+---------+
|   --    | > 61.97 | > 51.35 |         | 71.41 ± | 71.27 ± | > 72.06 |
| ------- | > ±     | > ±     | ------- | 1.63    | 0.58    | > ±     |
|         | > 0.24  | > 3.01  |         | 71.96 ± | 70.45 ± | > 1.93  |
| **ELU** | > 61.33 | > 67.47 | 72.57 ± | 0.94    | 0.73    | > 72.99 |
|   --    | > ±     | > ±     |   1.76  | 72.77 ± | 70.58 ± | > ±     |
| ------- | > 0.34  | > 0.44  |         | 0.49    | 0.45    | > 1.35  |
|         | > 61.13 | > 65.72 | ------- |         |         | > 73.33 |
|   --    | > ±     | > ±     |         |         |         | > ±     |
| ------- | > 0.41  | > 0.14  |         |         |         | > 1.25  |
|         |         |         | ------- |         |         |         |
| *       |         |         |         |         |         |         |
| *ReLU** |         |         | 74.05 ± |         |         |         |
|         |         |         | 1.69    |         |         |         |
|   ----  |         |         |         |         |         |         |
| ------- |         |         |         |         |         |         |
|   **    |         |         | ------- |         |         |         |
| LReLU** |         |         |         |         |         |         |
|   ----  |         |         | 63.79 ± |         |         |         |
| ------- |         |         |   2.38  |         |         |         |
|         |         |         |         |         |         |         |
|   ----  |         |         | ------- |         |         |         |
| ------- |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         | ------- |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| **T     |         |         |         |         |         |         |
| raining |         |         |         |         |         |         |
| time    |         |         |         |         |         |         |
| com     |         |         |         |         |         |         |
| parison |         |         |         |         |         |         |
| over    |         |         |         |         |         |         |
| C       |         |         |         |         |         |         |
| IFAR100 |         |         |         |         |         |         |
| da      |         |         |         |         |         |         |
| taset** |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| **Activ | **Mobi  | **      | **Goog  | **Res   | **SE    | *       |
| ation** | leNet** | VGG16** | leNet** | Net50** | Net18** | *DenseN |
|         |         |         |         |         |         | et121** |
+---------+---------+---------+---------+---------+---------+---------+
| **ELU** | > 0     | > 0     | 0       | > 0     | > 0     | > 0     |
|         | 0:31:05 | 0:47:38 | 4:57:37 | 3:36:47 | 1:13:25 | 4:08:39 |
|   ---   | > 0     | > 0     |         | > 0     | > 0     | > 0     |
| ------- | 0:31:22 | 0:47:19 | <table> | 3:32:30 | 1:15:33 | 4:15:06 |
|   *     | > 0     | > 0     | <co     | > 0     | > 0     | > 0     |
| *ReLU** | 0:31:48 | 0:49:03 | lgroup> | 3:33:00 | 1:18:38 | 4:14:09 |
|   ---   |         |         | <col    |         |         |         |
| ------- |         |         | s       |         |         |         |
|         |         |         | tyle="w |         |         |         |
|   ---   |         |         | idth: 1 |         |         |         |
| ------- |         |         | 00%" /> |         |         |         |
|         |         |         | </co    |         |         |         |
| **      |         |         | lgroup> |         |         |         |
| LReLU** |         |         | <thead> |         |         |         |
|         |         |         | <tr     |         |         |         |
|         |         |         | c       |         |         |         |
|         |         |         | lass="h |         |         |         |
|         |         |         | eader"> |         |         |         |
|         |         |         | <t      |         |         |         |
|         |         |         | h><bloc |         |         |         |
|         |         |         | kquote> |         |         |         |
|         |         |         | <       |         |         |         |
|         |         |         | p>04:55 |         |         |         |
|         |         |         | :10</p> |         |         |         |
|         |         |         | </bl    |         |         |         |
|         |         |         | ockquot |         |         |         |
|         |         |         | e></th> |         |         |         |
|         |         |         | </tr>   |         |         |         |
|         |         |         | <       |         |         |         |
|         |         |         | /thead> |         |         |         |
|         |         |         | <tbody> |         |         |         |
|         |         |         | <       |         |         |         |
|         |         |         | /tbody> |         |         |         |
|         |         |         | <       |         |         |         |
|         |         |         | /table> |         |         |         |
|         |         |         |         |         |         |         |
|         |         |         | 0       |         |         |         |
|         |         |         | 5:01:30 |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

> TAULA 3: COMPARATIVA SOBRE CIFAR100 ADAPTAT
>
> DE "ACTIVATION FUNCTIONS IN DEEP LEARNING: A
>
> COMPREHENSIVE SURVEY AND BENCHMARK."
>
> **5.3 LSTM Bidireccional**
>
> L'**LSTM bidireccional** consta de dues rutes d'entrada pa-
>
> ral·leles, una d'elles processa la seq¨u\` encia de l'esquerra a
>
> la dreta, mentre que l'altra ho fa de dreta a esquerra, aquest
>
> tret permet que el model processi la seq¨u\` encia de dades en
>
> dues direccions, proporcionant a la xarxa m´es context de la
>
> seq¨u\` encia.
>
> Per avaluar els diferents tipus de models, generarem per
>
> cada tipus d'activaci´o esmentada un model amb **LSTM tra-**
>
> **dicional** i un amb bidireccional, tenint tots ells el mateix
>
> model estructurat inicialment.
>
> **5.4 M\` etriques d'avaluaci´o**
>
> Les m\` etriques que s'usaran durant l'estudi per avaluar com
>
> d'adient ´es el model i el tipus d'activaci´o escollida per la
>
> nostra tasca, seran com a p\` erdua **MSE**, com a m\` etrica **MA-**
>
> **PE**, i **R2**.

6 TFG GESTI ´O CIUTATS INTEL·LIGENTS: Predicci´o de la demanda energ\`
etica de Barcelona

> • **MSE** (Mean Squared Error): mitjana del quadrat de les
>
> difer\` encies entre els valors predits i els reals. Penalitza
>
> m´es les prediccions allunyades.

+-----------------------+-----------------------+-----------------------+
| > *MSE* = 1 *n*       | *n*                   | > (*yi −*ˆ*yi*)2      |
+=======================+=======================+=======================+
|                       | *i*=1                 |                       |
+-----------------------+-----------------------+-----------------------+

> • **MAPE** (Mean Absolute Percentage Error): mitjana
>
> dels errors relatius absoluts en percentatge.

+-----------------+-----------------+-----------------+-----------------+
| *MA* = 1        | *n*             | *yi −*ˆ*yi*     | 100             |
+=================+=================+=================+=================+
|   ------------- | > *i*=1         | *yi*            | > *×*100        |
|   *MA* = *n*    |                 |                 |                 |
|   ------ ------ |                 |                 |                 |
|                 |                 |                 |                 |
|   ------------- |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

> • **R²** (Coeficient de Determinaci´o): indica la proporci´o
>
> de variabilitat explicada pel model. Proper a 1 significa
>
> bon ajustament.
>
> **5.6 Efecte de Batch Normalization**
>
> Batch Normalization normalitza les activacions de cada
>
> capa utilitzant la mitjana i vari\` ancia del *batch* durant l'en-
>
> trenament. No obstant aix\` o, en infer\` encia (validaci´o i test),
>
> s'utilitza la mitjana i vari\` ancia acumulades de tot el conjunt
>
> d'entrenament, fent que les prediccions siguin m´es estables.
>
> • **Durant l'entrenament:** la capa normalitza la seva
>
> sortida utilitzant la mitjana i la desviaci´o est\` andard del
>
> *batch* actual d'entrades. ´Es a dir, per a cada canal que
>
> s'est\` a normalitzant i dificultant la converg\` encia. La
>
> capa retorna:

*γ ·*batch *[−]{.underline}*mean(batch) + *β*

> A continuaci´o es detallen els termes:

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="5"><strong>5.5</strong></th>
<th rowspan="3"><em>R</em>2= 1 <em>−</em></th>
<th rowspan="5"><blockquote>
<p><em>n</em><br />
<em>i</em>=1(<em>yi −</em>ˆ<em>i</em>=1(<em>yi −</em>¯ <em>yi</em>)2</p>
</blockquote>
<p><em>y</em>)2</p></th>
<th colspan="7"><blockquote>
<p><strong>–</strong> <em>ϵ</em> is a small constant (configurable as
part of the</p>
</blockquote></th>
</tr>
<tr class="odd">
<th colspan="7"><blockquote>
<p>constructor arguments),</p>
</blockquote></th>
</tr>
<tr class="header">
<th><strong>–</strong> <em>γ</em></th>
<th>is</th>
<th>a</th>
<th>learned</th>
<th>scaling</th>
<th>factor</th>
<th><blockquote>
<p>(initialized</p>
</blockquote></th>
</tr>
<tr class="odd">
<th rowspan="2"><blockquote>
<p><strong>Resultats</strong></p>
</blockquote></th>
<th colspan="2">as 1),</th>
<th colspan="5"><blockquote>
<p>which can be disabled by passing</p>
</blockquote></th>
</tr>
<tr class="header">
<th colspan="7"><blockquote>
<p>scale=False to the constructor,</p>
</blockquote></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

Com podem observar, els models on s'ha aplicat l'**LSTM**

**bidireccional**, generalment han obtingut millors resultats

fent ´us la mateixa activaci´o. En canvi el millor resultat,

s'ha obtingut a trav´es del model amb LSTM tradicional i

l'activaci´o ELU.

> ![](vertopal_26daa422dcf144e8902c6c12a37ac5c5/media/image16.png){width="3.2444444444444445in"
> height="2.1444444444444444in"}
>
> Fig. 16: Resultats dels diferents models.

+-----------------------------------------------------------------------+
| > Per altra banda es pot afirmar que l'activaci´o **ELU**, la m´es    |
|                                                                       |
| costosa computacionalment, ha destacat pels seus resultats            |
|                                                                       |
| respecte la resta d'activacions de la familia **ReLU**, seguida       |
|                                                                       |
| per **LeakyReLU** i per ´ultim **ReLU** la menys costosa d'elles.     |
+=======================================================================+
+-----------------------------------------------------------------------+

+-----------------------+-----------------------+-----------------------+
| > **Model**           | **MAPE**              | *R*2                  |
+=======================+=======================+=======================+
| > LSTM ELU            | 1.7424                | 0.9683                |
+-----------------------+-----------------------+-----------------------+
| > BI LSTM ELU         | 1.7919                | 0.9671                |
+-----------------------+-----------------------+-----------------------+
| BI LSTM LEAKY         | 1.8283                | 0.9659                |
+-----------------------+-----------------------+-----------------------+
| > LSTM LEAKY          | 1.8567                | 0.9647                |
+-----------------------+-----------------------+-----------------------+
| > LSTM RELU           | 2.0296                | 0.9591                |
+-----------------------+-----------------------+-----------------------+
| > BI LSTM RELU        | 2.2039                | 0.9550                |
+-----------------------+-----------------------+-----------------------+

> TAULA 4: M´ETRIQUES DELS DIFERENTS MODELS.
>
> Per les dades de test, podem apreciar que tots els mo-

dels han obtingut millors resultats que durant l'entrena-

ment, per\` o m\` etriques molt similars al conjunt de dades de

validaci´o. Aquest fenomen ´es causat per l'´us d'una forta

regularitzaci´o. En el nostre cas, la capa Dropout i Batch

Normalization.

> **--** *β*is a learned offset factor (initialized
>
> as 0), which can be disabled by passing
>
> center=False to the constructor.
>
> • **Durant la validaci´o/test:** La capa normalitza la se-
>
> va sortida utilitzant una mitjana m\` obil de la mitjana i
>
> la desviaci´o est\` andard dels batches que ha vist durant
>
> l'entrenament, fent que el model sigui m´es estable i
>
> aconsegueixi una millor generalitzaci´o. Retorna:
>
> *γ ·*batch *[−]{.underline}*self.movingmean + *β*
>
> A continuaci´o es detallen els termes:
>
> **-- self.movingmean** and **self.movingvar** s´on va-
>
> riables no entrenables que s'actualitzen cada ve-
>
> gada que la capa ´es cridada en mode d'entrena-
>
> ment, de la manera seg¨uent:
>
> movingmean = movingmean*·*momentum+mean(batch)*·*(1*−*momentum)
>
> movingvar = movingvar*·*momentum+var(batch)*·*(1*−*momentum)
>
> La capa nom´es normalitzar\` a les seves entrades durant
>
> la infer\` encia despr´es d'haver estat entrenada amb da-
>
> des que tinguin estad´ıstiques similars a les de les dades
>
> d'infer\` encia.
>
> **5.7 Efecte de Dropout**
>
> Dropout ´es una t\` ecnica de regularitzaci´o que tracta de
>
> desactivar de manera aleat\` oria un percentatge de neurones,
>
> en cada *forward pass* durant l'entrenament. Tret que obliga
>
> al model a ser m´es robust i evitar la depend\` encia excessiva
>
> de certes neurones.
>
> • **Durant l'entrenament:** El model realitza l'entrena-
>
> ment amb una arquitectura "degradada", fet que re-
>
> dueix la seva capacitat i augmentar la p\` erdua durant
>
> aquest proc´es.
>
> • **Durant la validaci´o/test:** La t\` ecnica de regularitzaci´o
>
> Dropout no s'aplica, i totes les neurones estan actives,
>
> fent que el model funcioni amb el seu potencial total.

+-----------------------+-----------------------+-----------------------+
| AUTOR: Aleix Franc´ıa |                       | 7                     |
| Albert                |                       |                       |
|                       |                       | > \[8\] Laura Melgar  |
|                       |                       | > Garc´ıa, Jos´e      |
|                       |                       | > Francisco Torres    |
|                       |                       | > Maldo-              |
|                       |                       | >                     |
|                       |                       | > nado, Alicia        |
|                       |                       | > Troncoso, and Jos´e |
|                       |                       | > Crist´obal Riquelme |
|                       |                       | >                     |
|                       |                       | > Santos, "T´ecnicas  |
|                       |                       | > big data para la    |
|                       |                       | > predicci´on de la   |
|                       |                       | > de-                 |
|                       |                       | >                     |
|                       |                       | > manda y precio      |
|                       |                       | > el´ectrico,"        |
|                       |                       | > *Economia           |
|                       |                       | > Industrial*, 2024.  |
+=======================+=======================+=======================+
| > **6**               | > **CONCLUSIONS**     |                       |
+-----------------------+-----------------------+-----------------------+
| <table>               |                       |                       |
| <colgroup>            |                       |                       |
| <col                  |                       |                       |
| style="width: 33%" /> |                       |                       |
| <col                  |                       |                       |
| style="width: 33%" /> |                       |                       |
| <col                  |                       |                       |
| style="width: 33%" /> |                       |                       |
| </colgroup>           |                       |                       |
| <thead>               |                       |                       |
| <tr class="header">   |                       |                       |
| <th><blockquote>      |                       |                       |
| <p><stro              |                       |                       |
| ng>Model</strong></p> |                       |                       |
| </blockquote></th>    |                       |                       |
| <th><stro             |                       |                       |
| ng>MAPE</strong></th> |                       |                       |
| <th><em>R</em>2</th>  |                       |                       |
| </tr>                 |                       |                       |
| </thead>              |                       |                       |
| <tbody>               |                       |                       |
| </tbody>              |                       |                       |
| </table>              |                       |                       |
+-----------------------+-----------------------+-----------------------+

+-----------------------+-----------------------+-----------------------+
| **LSTM Models**       |                       |                       |
+=======================+=======================+=======================+
| +------------------+  | > 1.7424 1.8567       | > 0.9683 0.9647       |
| | > LSTM ELU       |  | > 2.0296              | > 0.9591              |
| +==================+  |                       |                       |
| +------------------+  |                       |                       |
|                       |                       |                       |
| > LSTM LEAKY          |                       |                       |
|                       |                       |                       |
| +------------------+  |                       |                       |
| | > LSTM RELU      |  |                       |                       |
| +==================+  |                       |                       |
| +------------------+  |                       |                       |
+-----------------------+-----------------------+-----------------------+

+-----------------------+-----------------------+-----------------------+
| **Bidirectional LSTM  |                       |                       |
| Models**              |                       |                       |
+=======================+=======================+=======================+
| +------------------+  | > 1.7919 1.8283       | > 0.9671 0.9659       |
| | > BI LSTM ELU    |  | > 2.2039              | > 0.9550              |
| +==================+  |                       |                       |
| +------------------+  |                       |                       |
|                       |                       |                       |
| > BI LSTM LEAKY       |                       |                       |
|                       |                       |                       |
| +------------------+  |                       |                       |
| | > BI LSTM RELU   |  |                       |                       |
| +==================+  |                       |                       |
| +------------------+  |                       |                       |
+-----------------------+-----------------------+-----------------------+

+-----------------------+-----------------------+-----------------------+
| **XGBoost Models**    |                       |                       |
+=======================+=======================+=======================+
|   ------------------  | > 1.7417 1.8020       | > 0.9665 0.9647       |
|   XGBoost using a     | > 1.8492              | > 0.9631              |
|   Monte Carlo         |                       |                       |
|   Ensemble            |                       |                       |
|   ------------------  |                       |                       |
|                       |                       |                       |
|   ------------------  |                       |                       |
|                       |                       |                       |
| > XGBoost using a     |                       |                       |
| > Bootstrap Ensemble  |                       |                       |
|                       |                       |                       |
| +------------------+  |                       |                       |
| | > Quantile       |  |                       |                       |
| | > Regression     |  |                       |                       |
| | > with XGBoost   |  |                       |                       |
| +==================+  |                       |                       |
| +------------------+  |                       |                       |
+-----------------------+-----------------------+-----------------------+

+-----------------------+-----------------------+-----------------------+
| **Random Forest       |                       |                       |
| Model**               |                       |                       |
+=======================+=======================+=======================+
| >                     | 1.4533                | 0.9684                |
| RandomForestRegressor |                       |                       |
+-----------------------+-----------------------+-----------------------+

> TAULA 5: RESULTATS DELS DIFERENTS MODELS.

\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .

> **AGRA¨IMENTS**

\... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .

> **REFER\` ENCIES**
>
> \[1\] S. R. Dubey, S. K. Singh, and B. B. Chaudhuri, "Ac-tivation
> functions in deep learning: A comprehensi-ve survey and benchmark,"
> *Neurocomputing*, vol. 503, pp. 92--108, 2022.
>
> \[2\] A. de Barcelona, "L'observatori de l'energia de barce-lona."

\[3\] ------, "Consum d'electricitat a barcelona open data."

> \[4\] \` Area Metropolitana de Barcelona, "Mapa energ\` etic."
>
> \[5\] O. Meteo, "Weather data api archive."
>
> \[6\] EPData, "´Index de producci´o industrial a catalunya (ine)."
>
> \[7\] G. James, D. Witten, T. Hastie, R. Tibshirani, and J. Taylor,
> *An Introduction to Statistical Learning: with Applications in
> Python*. Springer, 2023.
>
> \[9\] N. I. M. S. N. IMS), "The effect of batch size on the
> generalizability of the convolutional neural networks on a
> histopathology dataset," *ScienceDirect*, 2020.
>
> \[10\] S. M. Z. Z. Arjun Ghosh, Nanda Dulal Jana, "Desig-ning optimal
> convolutional neural network architectu-re using differential
> evolution algorithm," *CellPress*, 2022.
>
> \[11\] GeeksforGeeks, "What is lstm -- long short term me-mory?" 2025.
>
> \[12\] Keras Documentation, "Reduce learning rate on pla-teau
> callback," 2025.
>
> \[13\] R. Tavenard, *Deep Learning Basics (lecture notes)*, 2023.
>
> \[14\] P. Li, "Optimization algorithms for deep learning,"2017.
>
> \[15\] S. M. Z. Z. Arjun Ghosh, Nanda Dulal Jana, "Energy consumption
> prediction using modified deep cnn-bi lstm with attention mechanism,"
> *Heliyon*, 2025.
>
> \[16\] "Pytorch implementation of popular attention mecha-nisms,"
> 2023.
>
> \[17\] xgboosting, "Estimating the uncertainty or confidence of an
> xgboost model," 2024.

\[18\] P. Banerjee, "Xgboost hyperparameters tuning," 2020. \[19\] J.
Brownlee, "How to tune the number and size of de-cision trees with
xgboost in python," 2020.

> \[20\] nvidia, "What is xgboost?" 2025.
>
> \[21\] GeeksforGeeks, "Confidence intervals for xgboost,"2024.
>
> \[22\] M. G.-T. F. M.- A. T. Federico Divina, Jos´e Fran-cisco Torres
> Maldonado, "Spanish short-term electric energy consumption
> forecasting," 2020.
>
> \[23\] L. Yang, H. Ma, Y. Zhang, and S. Li, "Research on energy
> consumption prediction of public buil-dings based on improved support
> vector machine," in *2023 35th Chinese Control and Decision Conference
> (CCDC)*, 2023, pp. 2699--2704.
>
> \[24\] J. Li, X. Jiang, L. Shao, H. Liu, C. Chen, G. Wang, and D. Du,
> "Energy consumption data prediction analysis based on eemd-arma
> model," in *2020 IEEE Interna-tional Conference on Mechatronics and
> Automation (ICMA)*, 2020, pp. 1338--1342.
>
> \[25\] M. A. N. M. Asri, N. Zaini, and M. F. A. Latip, "De-velopment
> of an lstm-based model for energy con-sumption prediction with data
> pre-analysis," in *2021 11th IEEE International Conference on Control
> Sys-tem, Computing and Engineering (ICCSCE)*, 2021, pp. 228--233.

8 TFG GESTI ´O CIUTATS INTEL·LIGENTS: Predicci´o de la demanda energ\`
etica de Barcelona

\[26\] K. Yang, X. Yang, L. Zhou, L. Li, and X. Wang,\
"Regional energy prediction model based on cdc mo-\
del," in *2022 IEEE 5th Advanced Information Ma-*\
*nagement, Communicates, Electronic and Automation*\
*Control Conference (IMCEC)*, vol. 5, 2022, pp. 10--\
14.

\[27\] N. I. N. Komori, N. Zaini, and M. F. A. Latip, "Clas-\
sification and profiling of electricity consumption pat-\
terns using bayesian networks," in *2022 IEEE Sympo-*\
*sium on Industrial Electronics Applications (ISIEA)*,\
2022, pp. 1--6.

\[28\] J. Brownlee, "Time series forecasting with lstms,"\
2020.

\[29\] P. Kontschieder, M. Fiterau, A. Criminisi, and S. R.\
Bul\` o, "Deep neural decision forests," in *2015 IEEE*\
*International Conference on Computer Vision (ICCV)*,\
2015, pp. 1467--1475.

\[30\] K. Amasyali and N. M. El-Gohary, "A review of data-\
driven building energy consumption prediction stu-\
dies," *Renewable and Sustainable Energy Reviews*,\
vol. 81, pp. 1192--1205, 2018.

\[31\] F. S. Lars Siemer and D. Kleinhans, "Cost-optimal\
operation of energy storage units: Benefits of a\
problem-specific approach," *Journal of Energy Stora-*\
*ge 6*, 2016.

\[32\] K. Biel and C. H. Glock, "Systematic literature re-\
view of decision support models for energy-efficient\
production planning," *Computers Industrial Enginee-*\
*ring*, vol. 101, pp. 243--259, 2016.

\[33\] K. Team, "Dropout layer - keras api documentation,"\
2024.

\[34\] ------, "Batch normalization layer - keras api docu-\
mentation," 2024.

> **AP\` ENDIX**

**A.1** **Secci´o d'Ap\` endix**

\... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \...\
\..... \... \..... \... \... \..... \.... . \.... .. \.... .. \.... \...
\..... \... \..... \... \...\
\..... \.... . \.... .. \.... .. \.... \... \..... \... \..... \... \...
\..... \.... . \.... .. \.... ..\
\.... \... \..... \... \..... \... \... \..... \.... .

**A.2** **Secci´o d'Ap\` endix**

\... .. \.... .. \.... \... \..... \... \..... \... \... \..... \.... .
\.... .. \.... .. \.... \...\
\..... \... \..... \... \... \..... \.... . \.... .. \.... .. \.... \...
\..... \... \..... \... \...\
\..... \.... . \.... .. \.... .. \.... \... \..... \... \..... \... \...
\..... \.... . \.... .. \.... ..\
\.... \... \..... \... \..... \... \... \..... \.... .
